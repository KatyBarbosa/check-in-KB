<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Painel - Check-in</title>
   <link rel="icon" type="image/png" href="favicon.png" />
  <style>
    body{font-family:Arial,Helvetica,sans-serif;padding:20px;max-width:900px;margin:0 auto;}
    .card{border-radius:10px;padding:16px;margin:8px 0;border:1px solid #ddd;}
    h1{margin-top:0;}
    ul{padding-left:20px;}
  </style>
</head>
<body>
  <!-- Cabeçalho com imagem -->
  <div style="text-align:center; margin-bottom:20px;">
    <img src="cerimonialkb.png" alt="Monograma J & S" 
         style="width:120px; height:auto; border-radius:12px;"/>
  </div>
  <h1>Painel de Check-in</h1>
  <div id="stats" class="card">Carregando...</div>
  <div id="last" class="card">Últimos confirmados: carregando...</div>

<script>
const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzOA_IkLvKTLDC7ClBhz8NlZVFJ8Jh9Ag0CL6jJqn9bssGvzg3TR-1c8u_PI6mfVfkO/exec'; // substitua
const POLL_MS = 5000;

async function fetchResumo(){
  try{
    const res = await fetch(SCRIPT_URL + '?action=resumo');
    const data = await res.json();
    renderResumo(data);
  }catch(err){
    document.getElementById('stats').innerText = 'Erro ao buscar resumo: ' + err.message;
  }
}

function renderResumo(d){
  if(!d || d.status !== 'ok'){ document.getElementById('stats').innerText = 'Erro no resumo'; return; }
  const html = `
    <div><strong>Total convidados:</strong> ${d.total}</div>
    <div><strong>Check-ins realizados:</strong> ${d.checkins}</div>
    <div><strong>Percentual de chegada:</strong> ${d.percent}%</div>
  `;
  document.getElementById('stats').innerHTML = html;
  const last = d.last && d.last.length ? '<ol>' + d.last.map(n => `<li>${n}</li>`).join('') + '</ol>' : 'Nenhum ainda';
  document.getElementById('last').innerHTML = `<strong>Últimos confirmados:</strong> ${last}`;
}

fetchResumo();
setInterval(fetchResumo, POLL_MS);
</script>
</body>
</html>




